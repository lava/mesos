# Task Reasons

Some TaskStatus messages will arrive with the `reason` field set to a value
that can allow frameworks to display better error messages and to implement
special behaviour for some of the reasons.

For most reasons, the `message` field of the TaskStatus message will
give a more detailed, human-readable error description.

Not every status update does carry a reason.

## Deprecated Reasons

Reason `REASON_COMMAND_EXECUTOR_FAILED` is deprecated and will be removed
in the future. Please do not use it.

## Unused Reasons

The reasons `REASON_CONTAINER_LIMITATION`, `REASON_INVALID_FRAMEWORKID`,
`REASON_SLAVE_UNKNOWN` and `REASON_TASK_UNKNOWN` are currently not used
by mesos.

Frameworks are free to use them in their own status messages.

## Bound Reasons

For these status updates, the reason indicates *why* the task state changed.
Therefore, a given reason will always appear together with the same state.

Typically they are generated by mesos when an error occurs that prevents
the executor from sending its own status update messages.

Below, a partition-aware framework means a framework which has the
`Capability::PARTITION_AWARE` capability bit set in its FrameworkInfo.


#### For state `TASK_FAILED`

Reason: `REASON_CONTAINER_LAUNCH_FAILED`
Source: `SOURCE_SLAVE`
:   The task could not be launched because its container failed to launch.

<br/>

Reason: `REASON_CONTAINER_LIMITATION_MEMORY`
Source: `SOURCE_SLAVE`
:   The container in which the task was running exceeded its memory allocation.

<br/>

Reason: `REASON_CONTAINER_LAUNCH_FAILED`
Source: `SOURCE_SLAVE`
:   The task could not be launched because its container failed to launch.

<br/>

Reason: `REASON_CONTAINER_LIMITATION_DISK`
Source: `SOURCE_SLAVE`
:   The container in which the task was running exceeded exceeded its
    disk quota.

<br/>

Reason: `REASON_IO_SWITCHBOARD_EXITED`
Source: `SOURCE_SLAVE`
:   The I/O switchboard server terminated unexpectedly.

<br/>

Reason: `REASON_EXECUTOR_REGISTRATION_TIMEOUT`
Source: `SOURCE_SLAVE`
:   The executor for this task didn't register with the agent within the
    allowed time limit.

<br/>

Reason: `REASON_EXECUTOR_REREGISTRATION_TIMEOUT`
Source: `SOURCE_SLAVE`
:   The executor for this task lost connection and didn't re-register
    within the allowed time limit.

<br/>

Reason: `REASON_EXECUTOR_TERMINATED`
Source: `SOURCE_SLAVE`
:   The tasks' executor terminated abnormally, and no more specific reason
    could be determined.


#### For state `TASK_KILLED`:

Reason: `REASON_FRAMEWORK_REMOVED`
Source: `SOURCE_MASTER`
:   The framework to which this task belonged was removed.
    **Note:** The status update will be sent out before the task is
    actually killed.

<br/>

Reason: `REASON_EXECUTOR_UNREGISTERED`
Source: `SOURCE_SLAVE`
:   The task was requested to be killed while the executor was still
    registering.


### For state `TASK_ERROR`:

Reason: `REASON_TASK_INVALID`
Source: `SOURCE_MASTER`
:   Task or resource validation checks failed.

<br/>

Reason: `REASON_TASK_GROUP_INVALID`
Source: `SOURCE_MASTER`
:   Task group or resource validation checks failed.

<br/>

Reason: `REASON_TASK_UNAUTHORIZED`
Source: `SOURCE_MASTER`  or `SOURCE_SLAVE`
:   - With `SOURCE_MASTER`: Task authorization failed on the master.
    - With `SOURCE_SLAVE`:  Task authorization failed on the slave.

<br/>

Reason: `REASON_TASK_GROUP_UNAUTHORIZED`
Source: `SOURCE_MASTER` or `SOURCE_SLAVE`
:   - With `SOURCE_MASTER`: Task group authorization failed on the master.
    - With `SOURCE_SLAVE`:  Task group authorization failed on the slave.


#### For state `TASK_LOST`:

Reason: `REASON_SLAVE_DISCONNECTED`
Source: `SOURCE_MASTER`
:   The slave on which the task was running disconnected, and didn't
    reconnect in time.

<br/>

Reason: `REASON_SLAVE_DISCONNECTED`
State: `SOURCE_MASTER`
:   The task was part of an accepted offer, but the slave sending the
    offer disconnected in the meantime.
    **Note:** For partition-aware frameworks, the state will be changed
    to `TASK_DROPPED` instead.

<br/>

Reason: `REASON_MASTER_DISCONNECTED [x]`
State: `SOURCE_MASTER`
:   The task was part of an accepted offer which couldn't be sent to the
    master, because it was disconnected.
    **Note:** For partition-aware frameworks, the state will be changed
    to `TASK_DROPPED` instead.
    **Note:** Despite the source being set to `SOURCE_MASTER`, the message
    is not sent from the master but locally from the scheduler driver.

<br/>

Reason: `REASON_SLAVE_REMOVED`
Source: `SOURCE_MASTER`
:   The slave on which the task was running was removed.

<br/>

Reason: `REASON_SLAVE_REMOVED`
Source: `SOURCE_MASTER`
:   The task was part of an accepted offer, but the slave sending the offer
    was disconnected in the meantime.
    **Note:** For partition-aware frameworks, the state will be changed
    to `TASK_DROPPED` instead.

<br/>

Reason: `REASON_SLAVE_REMOVED`
Source: `SOURCE_MASTER`
:   The slave on which the task was running was marked unreachable.
    **Note:** For partition-aware frameworks, the state will be changed
    to `TASK_UNREACHABLE` instead.

<br/>

Reason: `REASON_RESOURCES_UNKNOWN`
Source: `SOURCE_MASTER`
:   The task was part of an accepted offer which used checkpointed resources
    that are not known to the master.
    **Note:** For partition-aware frameworks, the state will be changed
    to `TASK_DROPPED` instead.

<br/>

Reason: `REASON_SLAVE_RESTARTED`
Source: `SOURCE_SLAVE`
:   The task was launched during an agent restart, and never got forwarded
    to the executor.
    **Note:** For partition-aware frameworks, the state will be changed
    to `TASK_DROPPED` instead.

<br/>

Reason: `REASON_CONTAINER_PREEMPTED`
Source: `SOURCE_SLAVE`
:   The container in which the task was running was pre-empted by
    a QoS correction.
    **Note:** For  partition-aware frameworks, the state will be changed
    to `TASK_GONE` instead.

<br/>

Reason: `REASON_CONTAINER_UPDATE_FAILED`
Source: `SOURCE_SLAVE`
:   The container in which the task was running was discarded because a
    resource update failed.
    **Note:** For partition-aware frameworks, the state will be changed
    to `TASK_GONE` instead.

<br/>

Reason: `REASON_EXECUTOR_TERMINATED`
Source: `SOURCE_SLAVE`
:   The executor which was supposed to execute this task was already
    terminated, or the slave receives an instruction to kill the task before
    the executor was started.
    **Note:** For partition-aware frameworks, the state will be changed
    to `TASK_DROPPED`instead.

<br/>

Reason: `REASON_GC_ERROR`
Source: `SOURCE_SLAVE`
:   A directory to be used by this task was scheduled for GC and it could not
    be unscheduled.
    **Note:** For partition-aware frameworks, the state will be changed
    to `TASK_DROPPED` instead.

<br/>

Reason: `REASON_INVALID_OFFERS`
Source: `SOURCE_MASTER`
:   This task belonged to an accepted offer that didn't pass validation checks.
    **Note:** For partition-aware frameworks, the state will be changed
    to `TASK_DROPPED` instead.


#### For state `TASK_DROPPED`:

Reason: `REASON_SLAVE_DISCONNECTED`
Source: `SOURCE_MASTER`
:   See `TASK_LOST`.

<br/>

Reason: `REASON_SLAVE_REMOVED`
Source: `SOURCE_MASTER`
:   See `TASK_LOST`.

<br/>

Reason: `REASON_SLAVE_RESTARTED`
Source: `SOURCE_SLAVE`
:   See `TASK_LOST`.

<br/>

Reason: `REASON_RESOURCES_UNKNOWN`
Source: `SOURCE_MASTER`
:   See `TASK_LOST`.

<br/>

Reason: `REASON_GC_ERROR`
Source: `SOURCE_SLAVE`
:   See `TASK_LOST`.

<br/>

Reason: `REASON_INVALID_OFFERS`
Source: `SOURCE_MASTER`
:   See `TASK_LOST`.

#### For state `TASK_UNREACHABLE`:

Reason: `REASON_SLAVE_REMOVED`
Source: `SOURCE_MASTER`
:   See `TASK_LOST`.

#### For state `TASK_GONE`:

Reason: `REASON_CONTAINER_UPDATE_FAILED`
Source: `SOURCE_SLAVE`
:   See `TASK_LOST`.

<br/>

Reason: `REASON_CONTAINER_PREEMPTED`
Source: `SOURCE_SLAVE`
:   See `TASK_LOST`.

<br/>

Reason: `REASON_EXECUTOR_PREEMPTED`
Source: `SOURCE_SLAVE`
:   Renamed to `REASON_CONTAINER_PREEMPTED`
    in mesos 0.26


## Unbound Reasons

These reasons do not cause a state change, and will be sent along with the
last known state of the task. The reason field indicates *why* the status
update was sent.

Note that status updates with `REASON_RECONCILIATION` set are not the same
status updates that were originally sent from the framework, in particular
the `status.data` field is erased.

For a framework that wants to send custom data in some of its status
updates, the correct way to do it is to enable slave checkpointing,
ignore messages with reason `REASON_RECONCILIATION`, and wait until the
slave re-sends its original status update.


#### Possible Reasons

Reason: `REASON_TASK_CHECK_STATUS_UPDATED`
State: Any non-terminal state (`TASK_STAGING`, `TASK_STARTING`, `TASK_RUNNING`, `TASK_KILLING`)
Source: `SOURCE_SLAVE`
:   A task check notified the slave that its state changed.

<br/>

Reason: `REASON_TASK_HEALTH_CHECK_STATUS_UPDATED`
State: Any non-terminal state (`TASK_STAGING`, `TASK_STARTING`, `TASK_RUNNING`, `TASK_KILLING`)
Source: `SOURCE_SLAVE`
:   A task health check notified the slave that its state changed.

<br/>

Reason: `REASON_RECONCILIATION`
State: Any state
Source: `SOURCE_MASTER`
:   A framework requested implicit or explicit reconciliation for this task.
