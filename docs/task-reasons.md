## Task reasons

Some task state updates will arrive with the `reason` field set to a value
that can allow frameworks to display better error messages and to implement
special behaviour for some of the reasons.

For most reasons, the `message` field of the TaskState protobuf message will
give a more detailed, human-readable error description.

Not every status update will carry a reason.

# Deprecated reasons

Reason `REASON_COMMAND_EXECUTOR_FAILED` is deprecated and will be removed
in the future. Please do not use it.

# Unused reasons

The reasons `REASON_CONTAINER_LIMITATION`, `REASON_INVALID_FRAMEWORKID`,
`REASON_SLAVE_UNKNOWN` and `REASON_TASK_UNKNOWN` are currently not used
by mesos.

Frameworks are free to use them in their own status messages.

# Bound reasons

For these status updates, the reason indicates *why* the state changed.
Therefore, a given reason will always appear together with the same
task state.

Typically they are generated by mesos when an error occurs that prevents
the executor from sending its own status update messages.

In the below table, a partition-aware framework means a framework which has the
`Capability::PARTITION_AWARE` capability bit set in its FrameworkInfo.

Reasons marked with `[x]` have important notes in the description
column.


Reason                                   |   Source
  | Description
-------------------------------------------------------------------------------

* For state `TASK_FAILED`:

`REASON_CONTAINER_LAUNCH_FAILED`         | `SOURCE_SLAVE`
  | The task could not be launched because its container failed
  | to launch.
`REASON_CONTAINER_LIMITATION_MEMORY`     | `SOURCE_SLAVE`
  | The task's container exceeded its memory allocation
`REASON_CONTAINER_LIMITATION_DISK`       | `SOURCE_SLAVE`
  | The task's container exceeded its disk quota.
`REASON_IO_SWITCHBOARD_EXITED`           | `SOURCE_SLAVE`
  | The I/O switchboard server terminated unexpectedly.
`REASON_EXECUTOR_REGISTRATION_TIMEOUT`   | `SOURCE_SLAVE`
  | The executor for this task didn't register with the agent within the
  | allowed time limit.
`REASON_EXECUTOR_REREGISTRATION_TIMEOUT` | `SOURCE_SLAVE`
  | The executor for this task lost connection and didn't re-register
  | within the allowed time limit.
`REASON_EXECUTOR_TERMINATED`             | `SOURCE_SLAVE`
  | The tasks' executor terminated abnormally, and no more specific reason
  | could be determined.

* For state `TASK_KILLED`:

`REASON_FRAMEWORK_REMOVED`                | `SOURCE_MASTER`
  | The framework to which this task belonged was removed.
  | Note that the status update will be sent out before the task is
  | actually killed.
`REASON_EXECUTOR_UNREGISTERED`            | `SOURCE_SLAVE`
  | The task was requested to be killed while the executor was still
  | registering.

* For state `TASK_ERROR`:

`REASON_TASK_INVALID`                     | `SOURCE_MASTER`
  | Task or resource validation checks failed
`REASON_TASK_GROUP_INVALID`               | `SOURCE_MASTER`
  | Task group or resource validation checks failed
`REASON_TASK_UNAUTHORIZED`                | `SOURCE_MASTER`  or `SOURCE_SLAVE`
  | With `SOURCE_MASTER`: Task authorization failed on the master
  | With `SOURCE_SLAVE`:  Task authorization failed on the slave
`REASON_TASK_GROUP_UNAUTHORIZED`          | `SOURCE_MASTER` or `SOURCE_SLAVE`
  | With `SOURCE_MASTER`: Task group authorization failed on the master
  | With `SOURCE_SLAVE`:  Task group authorization failed on the slave

* For state `TASK_LOST`:


`REASON_SLAVE_DISCONNECTED`               | `SOURCE_MASTER`
  | The slave on which the task was running disconnected, and didn't
  | reconnect in time.
`REASON_SLAVE_DISCONNECTED [x]`           | `SOURCE_MASTER`
  | The task was part of an accepted offer, but the slave sending the
  | offer disconnected in the meantime.
  | For partition-aware frameworks, the state will be changed
  | to `TASK_DROPPED` instead.
`REASON_MASTER_DISCONNECTED [x]`          | `SOURCE_MASTER`
  | The task was part of an accepted offer which couldn't be sent to the
  | master, because it was disconnected.
  | For partition-aware frameworks, the state will be changed to `TASK_DROPPED`
  | instead.
  | Note that despite the source being set to `SOURCE_MASTER`, the message
  | is not sent from the master but locally from the scheduler driver.
`REASON_SLAVE_REMOVED`                    | `SOURCE_MASTER`
  | The slave on which the task was running was removed.
`REASON_SLAVE_REMOVED [x]`                | `SOURCE_MASTER`
  | The task was part of an accepted offer, but the slave sending the offer
  | was disconnected in the meantime.
  | For partition-aware frameworks, the state will be changed
  | to `TASK_DROPPED` instead.
`REASON_SLAVE_REMOVED [x]`                 | `SOURCE_MASTER`
  | The slave on which the task was running was marked unreachable.
  | For partition-aware frameworks, the state will be changed to
  | `TASK_UNREACHABLE` instead.
`REASON_RESOURCES_UNKNOWN [x]`             | `SOURCE_MASTER`
  | The task was part of an accepted offer which used checkpointed resources
  | that are not known to the master.
  | For partition-aware frameworks, the state will be changed to `TASK_DROPPED`
  | instead.
`REASON_SLAVE_RESTARTED [x]`               | `SOURCE_SLAVE`
  | The task was launched during an agent restart, and never got forwarded
  | to the executor.
  | For partition-aware frameworks, the state will be changed to `TASK_DROPPED`
  | instead.
`REASON_CONTAINER_PREEMPTED [x]`           | `SOURCE_SLAVE`
  | The container in which the task was running was pre-empted by a QoS correction.
  | For  partition-aware frameworks, the state will be changed to `TASK_GONE`
  | instead.
`REASON_CONTAINER_UPDATE_FAILED [x]`       | `SOURCE_SLAVE`
  | The container in which the task was running was discarded because a
  | resource update failed.
  | For partition-aware frameworks, the state will be changed to `TASK_GONE`
  | instead.
`REASON_EXECUTOR_TERMINATED [x]`            | `SOURCE_SLAVE`
  | The executor which was supposed to execute this task was already
  | terminated, or the slave receives an instruction to kill the task before
  | the executor was started.
  | For partition-aware frameworks, the state will be changed to `TASK_DROPPED`
  | instead.
`REASON_GC_ERROR [x]`                       | `SOURCE_SLAVE`
  | A directory to be used by this task was scheduled for GC and it could not
  | be unscheduled.
  | For partition-aware frameworks, the state will be changed to `TASK_DROPPED`
  | instead.
`REASON_INVALID_OFFERS [x]`                 | `SOURCE_MASTER`
  | This task belonged to an accepted offer that didn't pass validation checks.
  | For partition-aware frameworks, the state will be changed to `TASK_DROPPED`
  | instead.

* For state `TASK_DROPPED`:

`REASON_SLAVE_DISCONNECTED`      | `SOURCE_MASTER` | See `TASK_LOST`.
`REASON_SLAVE_REMOVED`           | `SOURCE_MASTER` | See `TASK_LOST`.
`REASON_SLAVE_RESTARTED`         | `SOURCE_SLAVE`  | See `TASK_LOST`.
`REASON_RESOURCES_UNKNOWN`       | `SOURCE_MASTER` | See `TASK_LOST`.
`REASON_GC_ERROR`                | `SOURCE_SLAVE`  | See `TASK_LOST`.
`REASON_INVALID_OFFERS`          | `SOURCE_MASTER` | See `TASK_LOST`.

* For state `TASK_UNREACHABLE`:

`REASON_SLAVE_REMOVED`           | `SOURCE_MASTER` | See `TASK_LOST`.

* For state `TASK_GONE`:

`REASON_CONTAINER_UPDATE_FAILED` | `SOURCE_SLAVE`  | See `TASK_LOST`.
`REASON_CONTAINER_PREEMPTED`     | `SOURCE_SLAVE`  | See `TASK_LOST`.
`REASON_EXECUTOR_PREEMPTED`      | `SOURCE_SLAVE`  | Renamed to `REASON_CONTAINER_PREEMPTED`
                                                   | in mesos 0.26


# Unbound Reasons

These reasons do not cause a state change, and will be sent along with the
last known state of the task. The reason field indicates *why* the status
update was sent.

Note that status updates with `REASON_RECONCILIATION` set are not the same
status updates that were originally sent from the framework, in particular
the `status.data` field is erased.

For a framework that wants to send custom data in some of its status
updates, the correct way to do it is to enable slave checkpointing,
ignore messages with reason `REASON_RECONCILIATION`, and wait until the
slave re-sends its original status update.


Reason                                    | Possible states
  | Source        | Description
-------------------------------------------------------------------------------------
`REASON_TASK_CHECK_STATUS_UPDATED`        | Any non-terminal state (`TASK_STAGING`,
                                          |  `TASK_STARTING`, `TASK_RUNNING`, `TASK_KILLING`)
  | `SOURCE_SLAVE`  | A task check notified the slave that its state changed.

`REASON_TASK_HEALTH_CHECK_STATUS_UPDATED` | Any non-terminal state (`TASK_STAGING`,
                                          |  `TASK_STARTING`, TASK_RUNNING, TASK_KILLING)
  | `SOURCE_SLAVE`  | A task health check notified the slave that its state changed.

`REASON_RECONCILIATION`                   | Any state
  | `SOURCE_MASTER` | A framework requested implicit or explicit reconciliation
                    | for this task.
